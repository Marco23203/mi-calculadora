<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Calculadora de Derivadas e Integrales</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="container">
    <header>
      <h1>Calculadora de Derivadas e Integrales</h1>
    </header>

    <main>
      <div class="input-area">
        <textarea id="input" placeholder="Escribe tu función, por ejemplo: 3*x^2 + 5*x + 2"></textarea>
        <input type="text" id="variable" value="x" placeholder="Variable (x, y, z)">
      </div>

      <div class="buttons">
        <button class="btn" onclick="calcularDerivada()">Derivada</button>
        <button class="btn" onclick="calcularIntegral()">Integral</button>
        <button class="btn" onclick="eliminar()">Eliminar</button>
      </div>

      <!-- Resultados -->
      <div class="resultado" id="resultadoDerivada">
        <h3>Resultado de la Derivada</h3>
        <p id="resultadoDerivadaTexto"></p>
      </div>

      <div class="resultado" id="resultadoIntegral">
        <h3>Resultado de la Integral</h3>
        <p id="resultadoIntegralTexto"></p>
      </div>

      <!-- Botón para mostrar instrucciones -->
      <button class="btn" onclick="mostrarInstrucciones()">Ver Instrucciones</button>

      <!-- Contenido de instrucciones -->
      <div id="instrucciones" style="display: none;">
        <h2>Cómo usar</h2>
        <ol>
          <li>Escribe una función como <code>x^2 + 3*x</code></li>
          <li>Haz clic en "Derivada" o "Integral"</li>
          <li>Verás el resultado abajo</li>
        </ol>

        <h2>Tecnologías</h2>
        <ul>
          <li>HTML</li>
          <li>CSS</li>
          <li>JavaScript</li>
          <li><a href="https://mathjs.org/">math.js</a></li>
        </ul>

        <h2>Cómo correr el proyecto localmente</h2>
        <ol>
          <li>Clona el repositorio:
            <pre><code>git clone https://github.com/tu-usuario/mi-calculadora.git</code></pre>
          </li>
          <li>Abre <code>index.html</code> en tu navegador</li>
        </ol>
      </div>
    </main>
  </div>

  <!-- Librería math.js -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/11.11.0/math.min.js"></script>
  
  <!-- Scripts propios -->
  <script src="derivadas.js"></script>

  <!-- Puedes mover esta parte a integrales.js si prefieres -->
  <script>
    function calcularIntegral() {
      const entrada = document.getElementById("input").value;
      const variable = document.getElementById("variable").value;
      const apiKey = "E9KHL6-9YJPV32LXT";

      const proxy = "https://cors-anywhere.herokuapp.com/";
      const url = `${proxy}https://api.wolframalpha.com/v2/query?input=integrate%20${encodeURIComponent(entrada)}%20d${variable}&format=plaintext&output=JSON&appid=${apiKey}`;

      fetch(url)
        .then(response => {
          if (!response.ok) {
            throw new Error("Error en la solicitud a WolframAlpha: " + response.status);
          }
          return response.json();
        })
        .then(data => {
          console.log("Respuesta de la API:", data);
          const pods = data.queryresult.pods;
          if (pods && pods.length > 0) {
            const resultadoPod = pods.find(pod => pod.title.toLowerCase().includes("result") || pod.title.toLowerCase().includes("indefinite integral"));
            const resultado = resultadoPod ? resultadoPod.subpods[0].plaintext : "No se encontró resultado claro.";
            document.getElementById("resultadoIntegralTexto").innerText = resultado;
          } else {
            document.getElementById("resultadoIntegralTexto").innerText = "No se encontró resultado.";
          }
        })
        .catch(err => {
          console.error("Hubo un error con la consulta:", err);
          document.getElementById("resultadoIntegralTexto").innerText = "Error al consultar WolframAlpha. Revisa la API key, conexión o CORS.";
        });
    }
  </script>

  <script src="script.js"></script>
</body>
</html>
